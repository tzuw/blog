---
layout: post
title: "MongoDB 開篇"
subtitle: "MongoDB 開篇"
date: 2020-04-17 22:09:00
catalog: true
author: "tzuw"
header-img:  "img/cement.png"
tags: [MongoDB] 
categories: [資料倉儲]
---

看了很多篇博文的介紹後，對於 MongoDB 的理論知識上總是似懂非懂，於是決定還是自己來整理一下。MongoDB 的設計是結合了關係型資料庫的核心能力和 NoSQL 的關鍵技術。其中，關係型數據庫的關鍵能力有：易於表達的查詢語句、支持索引、一致性，以及方便和已有的技術架構整合。而作為 NoSQL 它還擁有，靈活的資料模型 (Schema-free)、可水平擴展性 (分散式架構)，以及高可用的部署 (某個節點掛掉還是可以用)。下面分別展開。然後接下來的文章就圍繞這些特性吧。



##### **1. 易於表達的查詢語句**

```mongodb
db.getCollection('houses').find({"linkman":"黃先生"},{"linkman":true,"_id":false})
```



##### **2. 支持索引**

MongoDB 中的索引最簡單的有三種，單字段索引、復合索引，和多鍵值索引。其中，多鍵值索引針對鍵值是一個數組的情況。而復合索引則是針對經常會在一起查詢的字段進行優化，例如，對於租房信息中的聯繫人和地區，兩個信息一起創建索引。

```mongodb
db.getCollection('houses').createIndex({linkman:1, regionid:1})
```



##### **3. 方便和企業中已有的技術架構整合**

科普一個常用於構建Web項目的工具集 MEAN (MongoDB，Express，Angular 和 Node.js) 。其他，什麼時候用MongoDB 和 node.js 的常見應用可以參考這兩個鏈接 [ref](https://cnodejs.org/topic/58d4b894b3e60b982d089b36) [ref](https://segmentfault.com/q/1010000016910793)。



##### **4. 靈活的資料模型**

Schema-free。在 MongoDb 中，儘管每一筆資料的欄位型態可以不同，甚至連欄位都不一定相同，但是倘若就這樣任由使用者保存，那真的就沒有意義了。給你方便不是讓你當隨便。所以，還是會有一些基本的設計模式。例如，One-to-One、One-to-Few、One-to-Many、One-to-Squillions，等等。



##### **5. 一致性**

MongoDb 的一致性和 MySQL 中的一致性不太一樣，前者是 CAP 理論中的一致性，後者則是在 ACID 中的，這裡先不展開。主要先了解 MongoDB 只能做到 Eventually Consistency，即每次讀取的數據要嘛是最新的，要嘛就暫時無法讀取 (犧牲了可用性)。另外，MongoDB 中的 MongoDB Replica Set ，則有另一種意思的可用性，詳見高可用部署。



##### **6. 高可用部署**

高可用在此指的是縮短日常維護時間和因突發的系統崩潰導致的停機時間。例如，主備模式，保證有一個備份數據庫是可以在主節點異常時進行支援。此外，記錄一下 MongDB 官方提供的三種架構：Three Member Replica Sets、Replica Sets with Four or More Members、Geographically Distributed Replica Sets。



##### **7. 可水平擴展性**

NoSQL 數據庫都有的特性。可以很融合通過增加服務器來達到拓展空間的目的。MongoDB 中的 Sharding 就是為了水平擴展設計。



### 參考資料 & 擴展

1.  [http://mongodbcanred.blogspot.com/2015/01/mongodb.html](http://mongodbcanred.blogspot.com/2015/01/mongodb.html)
2.  [MongoDB 官方ppt](https://www.mongodb.com/presentations/webinar-schema-design-1)

